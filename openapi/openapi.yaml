openapi: 3.1.0
info:
 title: API Logs Service
 description: |
  A comprehensive API logging service built with hexagonal architecture.
  This service allows you to:
  - Manage projects with API keys
  - Log API requests and responses
  - Track users making API calls
  - Store headers and bodies on demand
  - Search and filter logs efficiently
 version: 1.0.0
 contact:
  name: API Support
  email: support@example.com

servers:
 - url: http://100.105.141.99:8080
   description: Local development server
 - url: http://localhost:8080
   description: Localhost server

tags:
 - name: Health
   description: Service health check
 - name: Projects
   description: Project management with API keys
 - name: Users
   description: User management and tracking
 - name: Logs
   description: API log management and search

components:
 securitySchemes:
  ApiKeyAuth:
   type: apiKey
   in: header
   name: X-API-Key
   description: Project API key for authentication

 schemas:
  # Project schemas
  Project:
   $ref: "./components/schemas/project.yaml#/Project"
  CreateProjectRequest:
   $ref: "./components/schemas/project.yaml#/CreateProjectRequest"
  UpdateProjectRequest:
   $ref: "./components/schemas/project.yaml#/UpdateProjectRequest"

  # User schemas
  User:
   $ref: "./components/schemas/user.yaml#/User"
  CreateUserRequest:
   $ref: "./components/schemas/user.yaml#/CreateUserRequest"
  UpdateUserRequest:
   $ref: "./components/schemas/user.yaml#/UpdateUserRequest"

  # API Log schemas
  APILog:
   $ref: "./components/schemas/apilog.yaml#/APILog"
  CreateLogRequest:
   $ref: "./components/schemas/apilog.yaml#/CreateLogRequest"
  APILogWithDetails:
   $ref: "./components/schemas/apilog.yaml#/APILogWithDetails"
  APILogHeaders:
   $ref: "./components/schemas/apilog.yaml#/APILogHeaders"
  APILogBody:
   $ref: "./components/schemas/apilog.yaml#/APILogBody"
  LogStats:
   $ref: "./components/schemas/apilog.yaml#/LogStats"

  # Common schemas
  Error:
   $ref: "./components/schemas/common.yaml#/Error"
  HealthResponse:
   $ref: "./components/schemas/common.yaml#/HealthResponse"
  PaginatedLogs:
   $ref: "./components/schemas/common.yaml#/PaginatedLogs"
  PaginatedProjects:
   $ref: "./components/schemas/common.yaml#/PaginatedProjects"
  PaginatedUsers:
   $ref: "./components/schemas/common.yaml#/PaginatedUsers"

paths:
 # Health endpoint
 /health:
  $ref: "./paths/health.yaml#/~1health"

 # Project endpoints
 /api/v1/projects:
  $ref: "./paths/projects.yaml#/~1api~1v1~1projects"
 /api/v1/projects/{id}:
  $ref: "./paths/projects.yaml#/~1api~1v1~1projects~1{id}"
 /api/v1/projects/{id}/regenerate-key:
  $ref: "./paths/projects.yaml#/~1api~1v1~1projects~1{id}~1regenerate-key"

 # User endpoints
 /api/v1/users:
  $ref: "./paths/users.yaml#/~1api~1v1~1users"
 /api/v1/users/by-identifier:
  $ref: "./paths/users.yaml#/~1api~1v1~1users~1by-identifier"
 /api/v1/users/{id}:
  $ref: "./paths/users.yaml#/~1api~1v1~1users~1{id}"

 # Log endpoints
 /api/v1/logs:
  $ref: "./paths/logs.yaml#/~1api~1v1~1logs"
 /api/v1/logs/stats:
  $ref: "./paths/logs.yaml#/~1api~1v1~1logs~1stats"
 /api/v1/logs/{id}:
  $ref: "./paths/logs.yaml#/~1api~1v1~1logs~1{id}"
 /api/v1/logs/{id}/details:
  $ref: "./paths/logs.yaml#/~1api~1v1~1logs~1{id}~1details"
 /api/v1/logs/{id}/headers:
  $ref: "./paths/logs.yaml#/~1api~1v1~1logs~1{id}~1headers"
 /api/v1/logs/{id}/body:
  $ref: "./paths/logs.yaml#/~1api~1v1~1logs~1{id}~1body"
